!function(){"use strict";var e=function(){function e(e,t,n,a){var o=this;void 0===n&&(n=1e3),void 0===a&&(a=2e3),this.DEFAULT_COLS=10,this.DEFAULT_ROWS=10,this.run=function(){var e=o.gameState.getState();o.gameView.updateField(e),o.gameView.updateActionsValues({isRunning:!1,cols:e[0].length,rows:e.length,speed:o.speedMsToPercent()}),o.gameView.onCellClick((function(e,t){o.gameState.changeCellState(e,t),o.gameView.updateField(o.gameState.getState())})),o.gameView.onFieldSizeChange((function(e,t){var n=0===e?o.DEFAULT_COLS:e,a=0===t?o.DEFAULT_ROWS:t;o.gameState.setSize(n,a),o.gameView.updateField(o.gameState.getState(!1)),o.gameView.updateActionsValues({cols:n,rows:a})})),o.gameView.onGameStateChange((function(e){e?(o.gameView.updateActionsValues({isRunning:e}),o.isRunning=e,o.runInterval()):o.stop()})),o.gameView.onSpeedChange(o.updateSpeed),o.gameView.onFieldClear((function(){o.gameState.clearState(),o.gameView.updateField(o.gameState.getState()),o.isRunning&&o.stop()}))},this.stop=function(){o.gameView.updateActionsValues({isRunning:!1}),clearInterval(o.interval),o.isRunning=!1},this.updateSpeed=function(e){o.speed=o.speedPercentToMs(e),o.isRunning&&(clearInterval(o.interval),o.runInterval())},this.getSpeed=function(){return o.speed},this.getStatus=function(){return o.isRunning},this.runInterval=function(){o.interval=window.setInterval((function(){o.gameState.nextGeneration();var e=o.gameState.getState();!e.reduce((function(e,t){return e+t.reduce((function(e,t){return e+t}),0)}),0)||o.gameState.checkReplayState()?(o.gameState.clearState(),o.gameView.updateField(e),o.stop()):o.gameView.updateField(e)}),o.speed)},this.gameState=e,this.gameView=t,this.speed=n,this.maxSpeed=a}return e.prototype.speedMsToPercent=function(){return 100-Math.round(this.speed/(this.maxSpeed/100))},e.prototype.speedPercentToMs=function(e){return Math.round(this.maxSpeed-e*(this.maxSpeed/100))},e}(),t=function(){function e(){document.querySelector("#app").innerHTML='\n      <div class="field"></div>\n      <div class="controls">\n        <div class="controls-size">\n          <label>Col: <input class="controls-size__item controls-size__item--col" type="number" min=3></label>\n          <label>Row: <input class="controls-size__item controls-size__item--row" type="number" min=3></label>\n        </div>\n        <label>Speed <input class="controls__speed" type="range" min=0 max=99></label>\n        <div class="controls-buttons">\n          <button class="controls__play"></button>\n          <button class="controls__clear">Clear Field</button>\n        </div>\n       \n      </div>\n    '}return e.prototype.updateField=function(e){var t=document.querySelector(".field");t.innerHTML="";for(var n=0;n<e.length;n+=1){var a=document.createElement("div");a.classList.add("field__row");for(var o=0;o<e[n].length;o+=1){var i=document.createElement("div");i.classList.add("field__col"),i.dataset.col=o.toString(),i.dataset.row=n.toString(),1===e[n][o]?i.classList.add("field__col--alive"):2===e[n][o]&&i.classList.add("field__col--undead"),a.appendChild(i)}t.appendChild(a)}},e.prototype.updateActionsValues=function(e){var t=e.cols,n=e.rows,a=e.isRunning,o=e.speed,i=document.querySelector(".controls__play"),r=document.querySelector(".controls-size__item.controls-size__item--col"),s=document.querySelector(".controls-size__item.controls-size__item--row"),l=document.querySelector(".controls__speed");void 0!==a&&(a?i.classList.add("controls__play--stop"):i.classList.remove("controls__play--stop")),void 0!==t&&(r.value=t.toString()),void 0!==n&&(s.value=n.toString()),void 0!==o&&(l.value=o.toString())},e.prototype.onCellClick=function(e){document.querySelector(".field").addEventListener("click",(function(t){var n=t.target;void 0!==n.dataset.col&&e(Number(n.dataset.col),Number(n.dataset.row))}))},e.prototype.onGameStateChange=function(e){document.querySelector(".controls__play").addEventListener("click",(function(t){var n=!t.target.classList.contains("controls__play--stop");e(n)}))},e.prototype.onFieldSizeChange=function(e){document.querySelector(".controls-size").addEventListener("change",(function(t){if(t.target.classList.contains("controls-size__item")){var n=document.querySelector(".controls-size__item--col"),a=document.querySelector(".controls-size__item--row"),o=Math.abs(Number(n.value)),i=Math.abs(Number(a.value));e(o,i)}}))},e.prototype.onFieldClear=function(e){document.querySelector(".controls__clear").addEventListener("click",(function(){e()}))},e.prototype.onSpeedChange=function(e){document.querySelector(".controls__speed").addEventListener("change",(function(){var t=document.querySelector(".controls__speed");e(Number(t.value))}))},e}();new e(new function(e,t){var n=this;this.getState=function(e){if(void 0===e&&(e=!0),!e)return n.state;for(var t=n.getNextGeneration(),a=0;a<n.state.length;a+=1)for(var o=0;o<n.state[0].length;o+=1)1===n.state[a][o]&&0===t[a][o]?n.state[a][o]=2:2===n.state[a][o]&&1===t[a][o]&&(n.state[a][o]=1);return n.state},this.changeCellState=function(e,t){0===n.state[t][e]?n.state[t][e]=1:n.state[t][e]=0},this.setSize=function(e,t){for(var a=[],o=0;o<t;o+=1){for(var i=[],r=0;r<e;r+=1){var s=0;n.state&&(s=n.state[o]&&void 0!==n.state[o][r]?n.state[o][r]:0),i[r]=s}a[o]=i}n.state=a},this.clearState=function(){for(var e=0;e<n.state.length;e+=1)for(var t=0;t<n.state[0].length;t+=1)n.state[e][t]=0},this.checkReplayState=function(){var e=n.getNextGeneration(),t=n.getNextGeneration(e);return n.state.join().replace(/2/g,"1")===t.join()},this.nextGeneration=function(){n.state=n.getNextGeneration()},this.getNextGeneration=function(e){for(var t=[],a=null!=e?e:n.state,o=0;o<a.length;o+=1){t[o]=[];for(var i=0;i<a[o].length;i+=1){var r=n.countAliveAround(i,o,a),s=a[o][i];t[o][i]=3===r||s&&2===r?1:0}}return t},this.countAliveAround=function(e,t,n){for(var a=0,o=t-1;o<=t+1;o+=1)if(void 0!==n[o])for(var i=e-1;i<=e+1;i+=1)t===o&&e===i||n[o][i]&&(a+=1);return a},this.setSize(e,t)}(10,10),new t,1e3,3e3).run()}();