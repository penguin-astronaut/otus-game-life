!function(){"use strict";var e=function(){function e(e){this.updateGameField=function(e){document.querySelector(".gameField").innerHTML="",e.forEach((function(e){var t=document.createElement("tr");e.forEach((function(e){var n,i=document.createElement("td");n=2===e?"cell--undead":1===e?"cell--alive":"cell--dead",i.classList.add("cell",n),t.append(i)})),document.querySelector(".gameField").append(t)}))};var t=e;t.innerHTML="\n      <table class='gameField'></table>\n      <div class='gameControls'>\n        <button class='run-button run-button--stopped'>Play</button>\n        <input type='number' class='field-size field-size--width'/>\n        <input type='number' class='field-size field-size--height'/>\n        <input type='range' class='field-speed' min=\"100\" max=\"3000\" />\n      </div>\n    ",document.body.appendChild(t)}return e.prototype.updateGameState=function(e){var t=e.width,n=e.height,i=e.isRunning,a=e.speed,r=document.querySelector(".run-button"),o=document.querySelector(".field-size.field-size--width"),u=document.querySelector(".field-size.field-size--height"),d=document.querySelector(".field-speed");void 0!==i&&(i?(r.classList.remove("run-button--stopped"),r.classList.add("run-button--runned"),r.innerHTML="Stop"):(r.classList.remove("run-button--runned"),r.classList.add("run-button--stopped"),r.innerHTML="Play")),void 0!==t&&(o.value=e.width.toString()),void 0!==n&&(u.value=e.height.toString()),void 0!==a&&(d.value=e.speed.toString())},e.prototype.onCellClick=function(e){document.querySelector(".gameField").addEventListener("click",(function(t){var n=t.target,i=n.parentNode,a=n.cellIndex,r=i.rowIndex;e(a,r)}))},e.prototype.onGameStateChange=function(e){document.querySelector(".run-button").addEventListener("click",(function(t){var n="Play"===t.target.innerHTML;e(n)}))},e.prototype.onFieldSizeChange=function(e){document.querySelector(".gameControls").addEventListener("change",(function(t){if(t.target.classList.contains("field-size")){var n=document.querySelector(".field-size.field-size--width"),i=document.querySelector(".field-size.field-size--height"),a=Number(n.value),r=Number(i.value);e(a,r)}}))},e.prototype.onSpeedChange=function(e){document.querySelector(".field-speed").addEventListener("change",(function(){var t=document.querySelector(".field-speed");e(Number(t.value))}))},e}();new function(e,t,n){var i=this;void 0===n&&(n=2e3),this.run=function(){var e=i.gameField.getState();i.gameView.updateGameField(e),i.gameView.updateGameState({isRunning:!1,width:e[0].length,height:e.length,speed:i.speed}),i.gameView.onCellClick((function(e,t){i.gameField.toggleCellState(e,t),i.gameView.updateGameField(i.gameField.getState())})),i.gameView.onFieldSizeChange((function(e,t){i.gameField.setSize(e,t),i.gameView.updateGameField(i.gameField.getState(!1)),i.gameView.updateGameState({width:e,height:t})})),i.gameView.onGameStateChange((function(e){e?(i.gameView.updateGameState({isRunning:e}),i.isRunning=e,i.runInterval()):i.stop()})),i.gameView.onSpeedChange(i.updateSpeed)},this.stop=function(){i.gameView.updateGameState({isRunning:!1}),clearInterval(i.interval),i.isRunning=!1},this.updateSpeed=function(e){i.speed=e,i.isRunning&&(clearInterval(i.interval),i.runInterval())},this.runInterval=function(){i.interval=setInterval((function(){i.gameField.nextGeneration();var e=i.gameField.getState(),t=e.reduce((function(e,t){return e+t.reduce((function(e,t){return e+t}),0)}),0);i.gameView.updateGameField(e),t||i.stop()}),i.speed)},this.gameField=e,this.gameView=t,this.speed=n}(new function(e,t){var n=this;void 0===e&&(e=0),void 0===t&&(t=1),this.countAliveAround=function(e,t){for(var i=0,a=t-1;a<=t+1;a+=1)if(void 0!==n.state[a])for(var r=e-1;r<=e+1;r+=1)t===a&&e===r||n.state[a][r]&&(i+=1);return i},this.getState=function(e){if(void 0===e&&(e=!0),!e)return n.state;for(var t=n.getNextGeneration(),i=0;i<n.state.length;i+=1)for(var a=0;a<n.state[0].length;a+=1)1===n.state[i][a]&&0===t[i][a]?n.state[i][a]=2:2===n.state[i][a]&&1===t[i][a]&&(n.state[i][a]=1);return n.state},this.toggleCellState=function(e,t){0===n.state[t][e]?n.state[t][e]=1:n.state[t][e]=0},this.nextGeneration=function(){n.state=n.getNextGeneration()},this.getNextGeneration=function(){for(var e=[],t=0;t<n.state.length;t+=1){e[t]=[];for(var i=0;i<n.state[t].length;i+=1){var a=n.countAliveAround(i,t),r=n.state[t][i];e[t][i]=3===a||r&&2===a?1:0}}return e},this.setSize=function(e,t){for(var i=[],a=0;a<t;a+=1){for(var r=[],o=0;o<e;o+=1){var u=0;n.state&&(u=n.state[a]&&void 0!==n.state[a][o]?n.state[a][o]:0),r[o]=u}i[a]=r}n.state=i},this.setSize(e,t)}(5,5),new e(document.querySelector("#app")),500).run()}();