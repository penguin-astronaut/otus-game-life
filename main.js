!function(){"use strict";var e=function(){function e(e,t,n,o){var a=this;void 0===n&&(n=1e3),void 0===o&&(o=2e3),this.run=function(){var e=a.gameState.getState();a.gameView.updateField(e),a.gameView.updateActionsValues({isRunning:!1,cols:e[0].length,rows:e.length,speed:a.speedMsToPercent()}),a.gameView.onCellClick((function(e,t){a.gameState.changeCellState(e,t),a.gameView.updateField(a.gameState.getState())})),a.gameView.onFieldSizeChange((function(e,t){a.gameState.setSize(e,t),a.gameView.updateField(a.gameState.getState(!1)),a.gameView.updateActionsValues({cols:e,rows:t})})),a.gameView.onGameStateChange((function(e){e?(a.gameView.updateActionsValues({isRunning:e}),a.isRunning=e,a.runInterval()):a.stop()})),a.gameView.onSpeedChange(a.updateSpeed),a.gameView.onFieldClear((function(){a.gameState.clearState(),a.gameView.updateField(a.gameState.getState()),a.isRunning&&a.stop()}))},this.stop=function(){a.gameView.updateActionsValues({isRunning:!1}),clearInterval(a.interval),a.isRunning=!1},this.updateSpeed=function(e){a.speed=a.speedPercentToMs(e),a.isRunning&&(clearInterval(a.interval),a.runInterval())},this.getSpeed=function(){return a.speed},this.getStatus=function(){return a.isRunning},this.runInterval=function(){a.interval=window.setInterval((function(){a.gameState.nextGeneration();var e=a.gameState.getState(),t=e.reduce((function(e,t){return e+t.reduce((function(e,t){return e+t}),0)}),0);a.gameView.updateField(e),t||a.stop()}),a.speed)},this.gameState=e,this.gameView=t,this.speed=n,this.maxSpeed=o}return e.prototype.speedMsToPercent=function(){return 100-Math.round(this.speed/(this.maxSpeed/100))},e.prototype.speedPercentToMs=function(e){return Math.round(this.maxSpeed-e*(this.maxSpeed/100))},e}(),t=function(){function e(){document.querySelector("#app").innerHTML='\n      <div class="field"></div>\n      <div class="controls">\n        <div class="controls-size">\n          <label>Col: <input class="controls-size__item controls-size__item--col" type="number"></label>\n          <label>Row: <input class="controls-size__item controls-size__item--row" type="number"></label>\n        </div>\n        <label>Speed <input class="controls__speed" type="range" min=0 max=99></label>\n        <div class="controls-buttons">\n          <button class="controls__play"></button>\n          <button class="controls__clear">Clear Field</button>\n        </div>\n       \n      </div>\n    '}return e.prototype.updateField=function(e){var t=document.querySelector(".field");t.innerHTML="";for(var n=0;n<e.length;n+=1){var o=document.createElement("div");o.classList.add("field__row");for(var a=0;a<e[n].length;a+=1){var i=document.createElement("div");i.classList.add("field__col"),i.dataset.col=a.toString(),i.dataset.row=n.toString(),1===e[n][a]?i.classList.add("field__col--alive"):2===e[n][a]&&i.classList.add("field__col--undead"),o.appendChild(i)}t.appendChild(o)}},e.prototype.updateActionsValues=function(e){var t=e.cols,n=e.rows,o=e.isRunning,a=e.speed,i=document.querySelector(".controls__play"),s=document.querySelector(".controls-size__item.controls-size__item--col"),r=document.querySelector(".controls-size__item.controls-size__item--row"),l=document.querySelector(".controls__speed");void 0!==o&&(o?i.classList.add("controls__play--stop"):i.classList.remove("controls__play--stop")),void 0!==t&&(s.value=t.toString()),void 0!==n&&(r.value=n.toString()),void 0!==a&&(l.value=a.toString())},e.prototype.onCellClick=function(e){document.querySelector(".field").addEventListener("click",(function(t){var n=t.target;void 0!==n.dataset.col&&e(Number(n.dataset.col),Number(n.dataset.row))}))},e.prototype.onGameStateChange=function(e){document.querySelector(".controls__play").addEventListener("click",(function(t){var n=!t.target.classList.contains("controls__play--stop");e(n)}))},e.prototype.onFieldSizeChange=function(e){document.querySelector(".controls-size").addEventListener("change",(function(t){if(t.target.classList.contains("controls-size__item")){var n=document.querySelector(".controls-size__item--col"),o=document.querySelector(".controls-size__item--row"),a=Number(n.value),i=Number(o.value);e(a,i)}}))},e.prototype.onFieldClear=function(e){document.querySelector(".controls__clear").addEventListener("click",(function(){e()}))},e.prototype.onSpeedChange=function(e){document.querySelector(".controls__speed").addEventListener("change",(function(){var t=document.querySelector(".controls__speed");e(Number(t.value))}))},e}();new e(new function(e,t){var n=this;this.getState=function(e){if(void 0===e&&(e=!0),!e)return n.state;for(var t=n.getNextGeneration(),o=0;o<n.state.length;o+=1)for(var a=0;a<n.state[0].length;a+=1)1===n.state[o][a]&&0===t[o][a]?n.state[o][a]=2:2===n.state[o][a]&&1===t[o][a]&&(n.state[o][a]=1);return n.state},this.changeCellState=function(e,t){0===n.state[t][e]?n.state[t][e]=1:n.state[t][e]=0},this.setSize=function(e,t){for(var o=[],a=0;a<t;a+=1){for(var i=[],s=0;s<e;s+=1){var r=0;n.state&&(r=n.state[a]&&void 0!==n.state[a][s]?n.state[a][s]:0),i[s]=r}o[a]=i}n.state=o},this.clearState=function(){for(var e=0;e<n.state.length;e+=1)for(var t=0;t<n.state[0].length;t+=1)n.state[e][t]=0},this.nextGeneration=function(){n.state=n.getNextGeneration()},this.getNextGeneration=function(){for(var e=[],t=0;t<n.state.length;t+=1){e[t]=[];for(var o=0;o<n.state[t].length;o+=1){var a=n.countAliveAround(o,t),i=n.state[t][o];e[t][o]=3===a||i&&2===a?1:0}}return e},this.countAliveAround=function(e,t){for(var o=0,a=t-1;a<=t+1;a+=1)if(void 0!==n.state[a])for(var i=e-1;i<=e+1;i+=1)t===a&&e===i||n.state[a][i]&&(o+=1);return o},this.setSize(e,t)}(10,10),new t,9e3,1e4).run()}();